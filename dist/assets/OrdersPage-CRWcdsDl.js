import{r as e,j as s}from"./ui-DmSYmwlh.js";import{c as t,u as a,b as r,a as n,s as i,t as d,P as c,B as l,f as m,g as o,d as x,G as p,J as u,V as h,K as g,N as f,O as j,C as N}from"./index-sG1ZoleV.js";import{C as y,c as b,S as v}from"./separator-C5Dcbw9Z.js";import{I as w}from"./ImageWithFallback-D00OHxEV.js";import{A as k}from"./arrow-left-BDiTJN5X.js";import{C as _}from"./circle-x-CnjQXyoU.js";import{T as C}from"./truck-BHGA4bM_.js";import"./vendor-CTYTkcnE.js";import"./supabase-CLG-Fze1.js";
/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=t("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function I(){const t=a(),{user:I}=r(),{addMultipleToCart:A}=n(),[S,O]=e.useState(null),[P,L]=e.useState([]);e.useEffect(()=>{I&&T()},[I]);const T=async()=>{const{data:e,error:s}=await i.from("orders").select("*, order_items(*)").eq("user_id",I.id).order("created_at",{ascending:!1});if(s)d.error("Failed to fetch orders");else{const s=e?.map(e=>({id:e.id,displayOrderId:e.display_order_id||"N/A",items:e.order_items.map(e=>({id:e.product_id,name:e.product_name,brand:e.product_brand,price:e.product_price,image:e.product_image,quantity:e.quantity})),subtotal:e.subtotal,tax:e.tax,shipping:e.shipping,discount:e.discount||0,total:e.total,status:e.status,paymentConfirmed:e.payment_confirmed,paymentConfirmedAt:e.payment_confirmed_at,paymentVerified:e.payment_verified,paymentVerifiedAt:e.payment_verified_at,paymentRejectionReason:e.payment_rejection_reason,createdAt:e.created_at,estimatedDelivery:e.estimated_delivery,shippingCompany:e.shipping_company,trackingId:e.tracking_id,trackingLink:e.tracking_link,shippingMethod:e.shipping_method,shippingNotes:e.shipping_notes,shippedAt:e.shipped_at,deliveredAt:e.delivered_at,deliveryNotes:e.delivery_notes,deliveryProofUrl:e.delivery_proof_url,shippingAddress:{name:e.shipping_name,address:e.shipping_address,city:e.shipping_city,state:e.shipping_state,zipCode:e.shipping_zip_code},paymentMethod:e.payment_method,upiId:e.upi_id}))||[];L(s)}},q=e=>{switch(e){case"placed":default:return s.jsx(N,{className:"w-4 h-4"});case"processing":return s.jsx(c,{className:"w-4 h-4"});case"shipped":return s.jsx(C,{className:"w-4 h-4"});case"delivered":return s.jsx(x,{className:"w-4 h-4"});case"cancelled":return s.jsx(_,{className:"w-4 h-4"})}},V=e=>{switch(e){case"placed":return"bg-orange-500/20 text-orange-300 border-orange-500/30";case"processing":return"bg-blue-500/20 text-blue-300 border-blue-500/30";case"shipped":return"bg-purple-500/20 text-purple-300 border-purple-500/30";case"delivered":return"bg-green-500/20 text-green-300 border-green-500/30";case"cancelled":return"bg-red-500/20 text-red-300 border-red-500/30";default:return"bg-muted text-muted-foreground"}},E=e=>{switch(e){case"placed":return"Order Placed";case"processing":return"Payment Confirmed";case"shipped":return"On the Way";case"delivered":return"Delivered";case"cancelled":return"Cancelled";default:return e}};return I?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx("div",{className:"border-b border-border/20 bg-background/95 backdrop-blur-sm sticky top-0 z-40",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(l,{variant:"ghost",onClick:()=>t(-1),className:"p-2",children:s.jsx(k,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"font-serif-premium text-2xl text-foreground",children:"Your Orders"}),s.jsx("p",{className:"text-muted-foreground",children:"Track and manage your purchases"})]})]})})}),s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:0===P.length?s.jsx(y,{className:"glass-card border-border/20",children:s.jsxs(b,{className:"text-center p-12",children:[s.jsx(c,{className:"w-16 h-16 text-accent mx-auto mb-4"}),s.jsx("h2",{className:"font-serif-premium text-2xl text-foreground mb-2",children:"No Orders Yet"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"When you place your first order, it will appear here."}),s.jsx(l,{onClick:()=>t("/"),className:"gold-gradient text-primary",children:"Start Shopping"})]})}):s.jsx("div",{className:"space-y-6",children:P.map(e=>s.jsx(y,{className:"glass-card border-border/20 hover:border-accent/30 transition-colors",children:s.jsxs(b,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-serif-premium text-lg text-foreground",children:["Order #",e.displayOrderId]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Placed on ",new Date(e.createdAt).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-serif-premium text-xl text-accent",children:m(e.total)}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs(o,{className:`${V(e.status)} flex items-center gap-1`,children:[q(e.status),E(e.status)]}),"REJECTED"===e.paymentVerified&&s.jsxs(o,{className:"bg-red-100 text-red-800 border-red-300 flex items-center gap-1",children:[s.jsx(_,{className:"w-3 h-3"}),"Payment Rejected"]}),"NO"===e.paymentVerified&&e.paymentConfirmed&&s.jsxs(o,{className:"bg-yellow-100 text-yellow-800 border-yellow-300 flex items-center gap-1",children:[s.jsx(D,{className:"w-3 h-3"}),"Pending Verification"]}),"YES"===e.paymentVerified&&s.jsxs(o,{className:"bg-green-100 text-green-800 border-green-300 flex items-center gap-1",children:[s.jsx(x,{className:"w-3 h-3"}),"Payment Verified"]})]})]})]}),(e.trackingId||e.shippingCompany)&&s.jsxs("div",{className:"mt-4 p-3 bg-muted/20 rounded-lg border border-border/20",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(C,{className:"w-4 h-4 text-accent"}),s.jsx("span",{className:"text-muted-foreground",children:"Tracking:"}),e.trackingId&&s.jsx("span",{className:"text-foreground font-mono text-xs bg-muted px-2 py-1 rounded",children:e.trackingId}),e.shippingCompany&&s.jsxs("span",{className:"text-foreground text-xs",children:["via ",e.shippingCompany]}),e.trackingLink&&s.jsx("a",{href:e.trackingLink,target:"_blank",rel:"noopener noreferrer",className:"text-accent hover:text-accent/80 underline text-xs ml-2",children:"Track →"})]}),e.estimatedDelivery&&s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[s.jsx(D,{className:"w-3 h-3"}),s.jsxs("span",{children:["Est. Delivery: ",new Date(e.estimatedDelivery).toLocaleDateString("en-IN")]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.items.slice(0,2).map(e=>s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 relative overflow-hidden rounded-lg",children:s.jsx(w,{src:e.image,alt:e.name,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-serif-premium text-sm text-foreground truncate",children:e.name}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.brand," • Qty: ",e.quantity]})]})]},e.id)),e.items.length>2&&s.jsxs("div",{className:"flex items-center justify-center text-sm text-muted-foreground",children:["+",e.items.length-2," more items"]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Order Progress"}),e.trackingNumber&&s.jsxs("span",{className:"text-xs text-accent",children:["Tracking: ",e.trackingNumber]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full "+(["pending","processing","shipped","delivered"].includes(e.status)?"bg-accent":"bg-muted")}),s.jsx("div",{className:"flex-1 h-1 "+(["processing","shipped","delivered"].includes(e.status)?"bg-accent":"bg-muted")}),s.jsx("div",{className:"w-3 h-3 rounded-full "+(["processing","shipped","delivered"].includes(e.status)?"bg-accent":"bg-muted")}),s.jsx("div",{className:"flex-1 h-1 "+(["shipped","delivered"].includes(e.status)?"bg-accent":"bg-muted")}),s.jsx("div",{className:"w-3 h-3 rounded-full "+(["shipped","delivered"].includes(e.status)?"bg-accent":"bg-muted")}),s.jsx("div",{className:"flex-1 h-1 "+("delivered"===e.status?"bg-accent":"bg-muted")}),s.jsx("div",{className:"w-3 h-3 rounded-full "+("delivered"===e.status?"bg-accent":"bg-muted")})]}),s.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[s.jsx("span",{className:"pending"===e.status?"text-accent font-medium":"",children:"Order Placed"}),s.jsx("span",{className:"processing"===e.status?"text-accent font-medium":"",children:"Confirmed"}),s.jsx("span",{className:"shipped"===e.status?"text-accent font-medium":"",children:"Shipped"}),s.jsx("span",{className:"delivered"===e.status?"text-accent font-medium":"",children:"Delivered"})]})]}),"delivered"!==e.status&&"cancelled"!==e.status&&s.jsx("div",{className:"bg-muted/20 p-3 rounded-lg mb-4",children:s.jsxs("p",{className:"text-sm text-foreground",children:[s.jsx(C,{className:"w-4 h-4 inline mr-2 text-accent"}),"Estimated delivery: ",new Date(e.estimatedDelivery).toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(p,{open:S?.id===e.id,onOpenChange:e=>!e&&O(null),children:[s.jsx(u,{asChild:!0,children:s.jsxs(l,{variant:"outline",size:"sm",onClick:()=>O(e),className:"flex-1",children:[s.jsx(h,{className:"w-4 h-4 mr-2"}),"View Details"]})}),s.jsxs(g,{className:"glass-card border-border/20 max-w-2xl max-h-[80vh] overflow-y-auto",children:[s.jsx(f,{children:s.jsxs(j,{className:"font-serif-premium",children:["Order Details - #",e.displayOrderId]})}),S&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(o,{className:`${V(S.status)} flex items-center gap-2`,children:[q(S.status),E(S.status)]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Order placed"}),s.jsx("p",{className:"font-sans-premium text-sm",children:new Date(S.createdAt).toLocaleString("en-IN")})]})]}),s.jsx(v,{className:"bg-border/20"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-serif-premium text-lg text-foreground mb-4",children:"Items"}),s.jsx("div",{className:"space-y-4",children:S.items.map(e=>s.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-border/20 rounded-lg",children:[s.jsx("div",{className:"w-16 h-16 relative overflow-hidden rounded-lg",children:s.jsx(w,{src:e.image,alt:e.name,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h5",{className:"font-serif-premium text-foreground",children:e.name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:e.brand}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Quantity: ",e.quantity]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-serif-premium text-foreground",children:m(e.price*e.quantity)}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[m(e.price)," each"]})]})]},e.id))})]}),s.jsx(v,{className:"bg-border/20"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-serif-premium text-lg text-foreground mb-4",children:"Order Summary"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),s.jsx("span",{className:"text-foreground",children:m(S.subtotal)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Shipping"}),s.jsx("span",{className:"text-accent",children:0===S.shipping?"Free":m(S.shipping)})]}),S.discount&&S.discount>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Lucky Discount"}),s.jsxs("span",{className:"text-green-600",children:["-",m(S.discount)]})]}),S.tax>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Tax"}),s.jsx("span",{className:"text-foreground",children:m(S.tax)})]}),s.jsx(v,{className:"my-2 bg-border/20"}),s.jsxs("div",{className:"flex justify-between font-medium text-base",children:[s.jsx("span",{className:"text-foreground",children:"Total"}),s.jsx("span",{className:"text-accent",children:m(S.total)})]})]})]}),s.jsx(v,{className:"bg-border/20"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-serif-premium text-lg text-foreground mb-3",children:"Delivery Address"}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsx("p",{className:"text-foreground font-medium",children:S.shippingAddress.name}),s.jsx("p",{className:"text-muted-foreground",children:S.shippingAddress.address}),s.jsxs("p",{className:"text-muted-foreground",children:[S.shippingAddress.city,", ",S.shippingAddress.state," ",S.shippingAddress.zipCode]})]})]}),(S.shippingCompany||S.trackingId||S.trackingLink)&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-serif-premium text-lg text-foreground mb-3",children:"Shipping Tracking"}),s.jsxs("div",{className:"text-sm space-y-2",children:[S.shippingCompany&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(C,{className:"w-4 h-4 text-accent"}),s.jsx("span",{className:"text-muted-foreground",children:"Company:"}),s.jsx("span",{className:"text-foreground font-medium",children:S.shippingCompany})]}),S.trackingId&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(c,{className:"w-4 h-4 text-accent"}),s.jsx("span",{className:"text-muted-foreground",children:"Tracking ID:"}),s.jsx("span",{className:"text-foreground font-mono bg-muted px-2 py-1 rounded text-xs",children:S.trackingId})]}),S.trackingLink&&s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("a",{href:S.trackingLink,target:"_blank",rel:"noopener noreferrer",className:"text-accent hover:text-accent/80 underline flex items-center gap-1",children:["Track Package",s.jsx(k,{className:"w-3 h-3 rotate-180"})]})}),S.shippedAt&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(N,{className:"w-4 h-4 text-accent"}),s.jsx("span",{className:"text-muted-foreground",children:"Shipped:"}),s.jsx("span",{className:"text-foreground",children:new Date(S.shippedAt).toLocaleDateString("en-IN")})]}),S.deliveredAt&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(x,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-muted-foreground",children:"Delivered:"}),s.jsx("span",{className:"text-foreground",children:new Date(S.deliveredAt).toLocaleDateString("en-IN")})]}),S.estimatedDelivery&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(D,{className:"w-4 h-4 text-accent"}),s.jsx("span",{className:"text-muted-foreground",children:"Est. Delivery:"}),s.jsx("span",{className:"text-foreground",children:new Date(S.estimatedDelivery).toLocaleDateString("en-IN")})]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-serif-premium text-lg text-foreground mb-3",children:"Payment Information"}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsxs("p",{className:"text-foreground",children:[S.paymentMethod," Payment"]}),S.paymentConfirmed&&S.paymentConfirmedAt&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-green-600 font-medium",children:"✓ Payment Confirmed by Customer"}),s.jsxs("p",{className:"text-muted-foreground",children:["Confirmed on ",new Date(S.paymentConfirmedAt).toLocaleString("en-IN")]}),s.jsxs("p",{className:"text-xs text-muted-foreground bg-yellow-50 p-2 rounded border border-yellow-200 mt-2",children:[s.jsx("strong",{children:"Note:"})," Payment confirmed by customer. Manual verification pending at backend."]})]}),S.upiId&&s.jsxs("p",{className:"text-muted-foreground",children:["UPI ID: ",S.upiId]}),S.trackingNumber&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-foreground font-medium mt-3",children:"Tracking Information"}),s.jsx("p",{className:"text-accent",children:S.trackingNumber})]})]})]})]})]})]})]}),"delivered"===e.status&&s.jsx(l,{size:"sm",variant:"outline",className:"gold-gradient text-primary",onClick:async()=>{try{const s=e.items.map(e=>({id:e.id,name:e.name,brand:e.brand,price:e.price,image:e.image,slug:e.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),description:"",is_active:!0,gallery_images:[e.image],rating:0,review_count:0,created_at:(new Date).toISOString()}));await A(s,e.items.map(e=>e.quantity)),d.success(`${e.items.length} item(s) added to cart!`),t("/checkout")}catch(s){console.error("Buy Again error:",s),d.error("Failed to add items to cart")}},children:"Buy Again"})]})]})},e.id))})})]}):s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsx(y,{className:"glass-card border-border/20 max-w-md",children:s.jsxs(b,{className:"text-center p-8",children:[s.jsx(c,{className:"w-12 h-12 text-accent mx-auto mb-4"}),s.jsx("h2",{className:"font-serif-premium text-2xl text-foreground mb-2",children:"Sign In Required"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Please sign in to view your orders."}),s.jsx(l,{onClick:()=>t("/"),children:"Back to Store"})]})})})}export{I as OrdersPage};
